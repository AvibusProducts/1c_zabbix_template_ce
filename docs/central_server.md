# Центральный сервер

Для мониторинга роли **Центрального сервера** реализован сбор следующих показателей:
* Доступность сервиса RAS по сетевому порту.
* Общее количество сеансов к информационным базам сервера;
* Количество сеансов фоновых заданий;
* Количество сеансов веб-сервисов;
* Количество сеансов http-сервисов;
* Количество спящих сеансов;
* Количество активных (находящихся в серверном вызове) сеансов;
* Максимальная длительность серди текущих интерактивных вызовов;
* Максимальная длительность среди текущих вызовов фоновых заданий;
* Максимальная длительность серди текущих вызовов веб-сервисов
* Максимальная длительность среди текущих вызовов http-сервисов.

**СОВЕТ:** Для надежного получения значений по сеансам необходимо на центральном сервере увеличить таймаут zabbibx-агента в зависимости от количество кластеров под управлением данного центраольного сервера, количества информационных баз и общего количества сеансов. Рекомендуемое значение - **10 сек**.

## Макросы для центрального сервера
В шаблоне рабочего сервера есть следующие макросы:
* **{$RAS_PORTS}** - порт(ы) сервера RAS, для кластера(ов), в котором(ых) данный сервер является центральным (в случае несколькихх значений, они указываются через запятую);
* **{$RAS_TIMEOUT}** - таймаут ожидания ответа от сервера RAS в секундах;
* **{$RAS_USER}** - имя пользователя-администратора кластера 1С Предприятия (предполагается, что учетные данные одинаковы для всех отслеживаемых кластеров);
* **{$RAS_PASS}** - пароль пользователя-администратора кластера 1С Предприятия (предполагается, что учетные данные одинаковы для всех отслеживаемых кластеров);
* **{$CALL_DUR_THRESHOLD}** - пороговое значение длительности интерактивного вызова.

## Триггеры
Для отслеживания критичных изменений показателей роли **Центрального сервера** созданы триггеры, срабатывающие при следующих событиях:
* Сетевой порт сервиса RAS недоступен (не отвечает). Уровень важности - **Высокая**

## Графики
Для визуализации показателей роли **Центрального сервера** предусмотрены следущие графики:
* Количество сеансов к информационным базам сервера.

## Правила обнаружения
В случае, когда центральный сервер управляет несколькими кластерами 1С Предприятия, для мониторинга сеансов в разрезе данных кластров необходимо активировать соответствующее **правило обнаружения** (по-умолчнию деактивировано). После этого сбор и отображение информации по сеансам станет доступным в разрезе кластеров, управляемых данным сервером лицензирования.
Вместе с тем шаблон центрального сервера имеет **правило обнаружения** для информационных баз, развернутых на данном сервере (по-умолчанию активно), что позвояет собирать и отображать информацию о сеансах в разрезе обнаруженных информационных баз.
Для информационной базы имеется прототип триггера, сигнализирующий о превышении порогового значения длительности интерактивного вызова.


[Назад](../README.md)
