# Установка
На сервере Zabbix необходимо добавить (экспортировать) файлы шаблонов:
* 1c_central_server.xml;
* 1c_work_server.xml;
* 1c_license_server.xml.

**ВАЖНО:** Так как шаблон сервера лицензирования стал наследовать шаблон рабочего сервера, то импорт шаблона рабочего сервера должен предшестовать импорту шаблона сервера лицензирования!

После чего назначить необходимый шаблон(ы) хосту, на котором работает 1С Предприятие. В шаблонах имеются макросы, позволяющие задавать требуемые пороги реагирования Zabbix (срабатывания триггеров).

На сервере с 1С Предприятием необходимо установить все скрипты по структуре каталогов репозитория (структура каталогов соответствует используемой в **CentOS**). А так же создать каталог для файлов технологического журнала (по-умолчанию **/var/log/1C**), в котором должен быть создан каталлог **zabbix** с вложенным каталогом **problem_log**. Таким образом, в рабочей системе структура каталогов и права на них выглядят следующим образом
<pre>$ ls -al /var/log/1C/zabbix/
итого 24
drwxr-xr-x 6 usr1cv8 grp1cv8 4096 Feb 25 12:29 .
drwxr-xr-x 4 root    root    4096 Feb 25 12:29 ..
drwxr-xr-x 2 usr1cv8 grp1cv8 4096 Aug 27  2019 calls
drwxr-xr-x 2 usr1cv8 grp1cv8 4096 Feb 25 12:29 excps
drwxr-xr-x 2 usr1cv8 grp1cv8 4096 Aug 27  2019 locks
drwxr-xr-x 2 zabbix  grp1cv8 4096 Aug 27  2019 problem_log
</pre>

Из файла **/opt/1C/noarch/conf/logcfg_zabbix_template.xml** необходимо перенести секции **log** в файл **logcfg.xml** рабочего сервера 1С Предприятия (или просто скопировать его в каталог /opt/1C/v8.3/тип_архитектуры/conf/, если сбор ТЖ не использовался).

**ВАЖНО:** Для корректной работы скриптов на сервере 1С Предприятия должны быть установлены следующие программы: zabbix-sender, zabbix-get, gawk (именно GNU AWK) и bc. Так же должен быть запущен RAS на центральном сервере кластера.

**ВАЖНО:** В случае многосерверного кластера 1С Предприятия, для корректной работы механизма сохранения файлов "проблемного" технологического журнала, необходимо на всех серверах, входящих в кластер, в настройке **Server** агента zabbix указать все сервера, входящие в кластер. Например, для кластера из двух серверов (**server_a** и **server_b**) на обоих серверах данная настройка агента zabbix должна выглядеть следующим образом:
<pre>Server=server_zabbix,server_a,server_b</pre>

[Назад](../README.md)
